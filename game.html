<!DOCTYPE html>
<html>
    <head>
        <title>Karopapier 2.1</title>
        <script type="text/javascript" src="js/libs/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="js/libs/jquery-ui-1.10.4.custom.min.js"></script>
        <script type="text/javascript" src="js/libs/underscore-min.js"></script>
        <script type="text/javascript" src="js/libs/backbone-min.js"></script>
        <script type="text/javascript" src="js/libs/backbone.marionette.min.js"></script>
        <script type="text/javascript" src="js/libs/backbone-model-factory-min.js"></script>
        <script type="text/javascript" src="js/libs/moment.min.js"></script>
        <!--<script type="text/javascript" src="js/libs/hammer.min.js"></script> -->
        <!--<script type="text/javascript" src="js/libs/Sideslide.js"></script> -->
        <!--<script type="text/javascript" src="js/libs/touch-emulator.js"></script>
        <script> TouchEmulator(); </script> -->

        <script type="text/javascript" src="js/libs/TURTED.js"></script>
        <script type="text/javascript" src="js/libs/sockjs-0.3.min.js"></script>

        <script type="text/javascript">
            var Karopapier = new Marionette.Application(); // currently only for Util.js to not throw an error
        </script>

        <script type="text/javascript" src="js/templates/JST.js"></script>
        <script type="text/javascript" src="js/KaroBackbone.js"></script>

        <link id="favicon" rel="shortcut icon" href="favicon.ico" />

        <link rel="stylesheet" href="css/main.css" />
        <link rel="stylesheet" href="css/global.css" />
        <link rel="stylesheet" href="css/game.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
        <meta charset="utf-8" />
    </head>
    <BODY BACKGROUND="/images/karolight.gif" BGCOLOR=#FFFFFF TEXT=#333399 LINK=#3333FF VLINK=#3333EE ALINK=#0000FF>
        <script type="text/javascript" src="http://www.karopapier.de/js/jquery.tablesorter.min.js"></script>
        <script type="text/javascript" src="http://www.karopapier.de/js/starvote.js"></script>
        <script type="text/javascript" src="http://www.karopapier.de/js/libs/json2.min.js"></script>
        <script type="text/javascript" src="http://www.karopapier.de/js/libs/store.min.js"></script>
        <script type="text/javascript" src="http://www.karopapier.de/js/libs/lz-string.min.js"></script>

        <style type="text/css">
            th.header {
                background-image: url(http://www.karopapier.de/images/bg.gif);
                background-repeat: no-repeat;
                background-position: center right;
            }

            th.headerSortUp {
                background-image: url(http://www.karopapier.de/images/asc.gif);
                background-repeat: no-repeat;
                background-position: center right;
            }

            th.headerSortDown {
                background-image: url(http://www.karopapier.de/images/desc.gif);
                background-repeat: no-repeat;
                background-position: center right;
            }
        </style>


        <script type="text/javascript">
            function chatlog() {
                var chatfenster = window.open("chat.php?GID=" + game.get("id"), "Fenster1", "width=800,height=500,left=100,top=100,scrollbars=yes,resizable=yes");
            }
        </script>


        <table border=0 width=100%>
            <tr>
                <td>
                    <h1 id="gameTitle" style="text-shadow: 2px 2px 0px rgba(100,100,200,0.5)">Schwippschwadron</h1>

                </td>
                <td>
                    <div style="float: left;" id="mapvotecontainer">
                        <b>Kartenbewertung</b>

                        <div class="mapvote" id="mapvote"></div>
                    </div>
                    <div id=gameInfo style="float: left"></div>
                    <div class="clearer"></div>
                </td>
            </tr>
        </table>

        <div style="position:absolute;right:0;top:0; font-size: 8pt">Experiment:<br />
            <img src="/images/loading.gif" id="pinstatus" style="height: 30px" /><br />
            Details <a href="http://www.karopapier.de/showthread.php?forumid=1&thread=960">hier</a></div>


        <div id="mapImage" style="position: relative;">
            <svg id="mapSvgView"></svg>
            <svg id="mapPlayerMoves" style="position: absolute; top:0; left:0; z-index: 5"></svg>
        </div>
        <div class="clearer"></div>

        Mitfahrer-Z&uuml;ge anzeigen: <a href="#" data-limit="0" class="drawLimiter">&nbsp;Alle&nbsp;</a>,
        <a href="#" data-limit="2" class="drawLimiter">&nbsp;2&nbsp;</a>,
        <a href="#" data-limit="5" class="drawLimiter">&nbsp;5&nbsp;</a>,
        <a href="#" data-limit="10" class="drawLimiter">&nbsp;10&nbsp;</a>
        - Dauerhafte &Auml;nderung <a href="/karte.php">hier</a>
        <br />
        <BR>

        Du bist dran, bitte mach Deinen Zug<BR>

        <form id="moveMsgForm">
            Didi:
            <input type="text" id="movemessage" size="80" maxlenght="255">
            <span id="movemessageDisplay" style="display: none"></span>
            <input type="submit" value="Nachricht mitschicken">
        </form>

        <script type="text/javascript">
            $('#moveMsgForm').submit(function (e) {
                var moveMsg = $('#movemessage').val();
                var w = $('#movemessage').width();
                if (moveMsg !== "") {
                    $('#movemessageDisplay').text(moveMsg).css({"display": "inline-block", "width": w});
                    $('#movemessage').hide();
                }
                e.preventDefault();
            });
            $('#movemessage').click(function () {
            });
        </script>

        <BR>

        <div id="moveMessagesView">
            <b>Bordfunk</b><br />
            <div id="moveMessages">
                <small>MrMM (14.10.2014): &quot;<i>Ich bin ausgestiegen</i>&quot;</small>
                <BR>
                <small>Stickerle (18.02.2014): &quot;<i>Ich werde 1 Z&uuml;ge zur&uuml;ckgesetzt</i>&quot;</small>
                <BR>
                <small>Stickerle (18.11.2013): &quot;<i>Ich werde 1 Z&uuml;ge zur&uuml;ckgesetzt</i>&quot;</small>
            </div>
        </div>
        <br />

        <div id="playerTable"></div>
        <TABLE BORDER=1 id="tabspielinfo">
            <thead>
                <TR>
                    <TH style="min-width: 80px">Farbe</TH>
                    <TH style="min-width:100px">Spieler</TH>
                    <TH>Z&uuml;ge</TH>
                    <TH>Runde</TH>

                    <TH>Checkpoints</TH>
                    <TH>Letzter Zug</TH>
                    <TH>Bedenkzeit</TH>
                    <TD>Kick</TD>
                    <TD>BE!</TD>
                </TR>
            </thead>
            <tbody>
                <TR>
                    <TD BGCOLOR=#ffea00>&nbsp</TD>
                    <TD>aristarch</TD>
                    <TD ALIGN=CENTER>46</TD>
                    <TD>&nbsp;<FONT COLOR=#00CC00>kommt noch</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-09 23:48:37</TD>
                    <TD>2 Tage, 10:36:33</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2231>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2231>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#ffffff>&nbsp</TD>
                    <TD>Didi</TD>
                    <TD ALIGN=CENTER>46</TD>
                    <TD>&nbsp;<B>dran</B></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-09 20:46:48</TD>
                    <TD>151 Tage, 16:38:54</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=1>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=1>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#FF0000>&nbsp</TD>
                    <TD>hasi</TD>
                    <TD ALIGN=CENTER>47</TD>
                    <TD>&nbsp;<FONT COLOR=#CC0000>war schon</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-13 11:48:07</TD>
                    <TD>19 Tage, 04:03:10</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2226>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2226>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#CCFF00>&nbsp</TD>
                    <TD>JokerHF</TD>
                    <TD ALIGN=CENTER>47</TD>
                    <TD>&nbsp;<FONT COLOR=#CC0000>war schon</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-13 23:05:49</TD>
                    <TD>6 Tage, 09:02:25</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2492>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2492>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#F0F0F0>&nbsp</TD>
                    <TD>kili</TD>
                    <TD ALIGN=CENTER>47</TD>
                    <TD>&nbsp;<FONT COLOR=#CC0000>war schon</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-14 09:07:46</TD>
                    <TD>2 Tage, 13:22:28</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=210>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=210>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#F7C9A3>&nbsp</TD>
                    <TD>Madeleine</TD>
                    <TD ALIGN=CENTER>46</TD>
                    <TD>&nbsp;<FONT COLOR=#00CC00>kommt noch</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-02 17:11:15</TD>
                    <TD>30 Tage, 06:23:45</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=563>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=563>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#000066>&nbsp</TD>
                    <TD>Michael</TD>
                    <TD ALIGN=CENTER>46</TD>
                    <TD>&nbsp;<FONT COLOR=#00CC00>kommt noch</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-13 10:23:23</TD>
                    <TD>91 Tage, 15:15:45</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2411>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2411>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#FF6600>&nbsp</TD>
                    <TD>mr-burns123</TD>
                    <TD ALIGN=CENTER>47</TD>
                    <TD>&nbsp;<FONT COLOR=#CC0000>war schon</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-13 19:00:30</TD>
                    <TD>10 Tage, 14:37:12</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2265>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2265>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#99FF33>&nbsp</TD>
                    <TD>MrMM</TD>
                    <TD ALIGN=CENTER>31</TD>
                    <TD>&nbsp;ausgestiegen</TD>
                    <TD ALIGN=CENTER>0/8</TD>
                    <TD>2014-10-14 21:22:27</TD>
                    <TD>150 Tage, 03:19:57</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2118>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2118>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#63B8FF>&nbsp</TD>
                    <TD>recke</TD>
                    <TD ALIGN=CENTER>47</TD>
                    <TD>&nbsp;<FONT COLOR=#CC0000>war schon</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-14 06:13:56</TD>
                    <TD>10 Tage, 01:18:14</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=1989>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=1989>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#FFFFCC>&nbsp</TD>
                    <TD>Schattenparker</TD>
                    <TD ALIGN=CENTER>22</TD>
                    <TD>&nbsp;ausgestiegen</TD>
                    <TD ALIGN=CENTER>0/8</TD>
                    <TD>2014-03-17 16:08:37</TD>
                    <TD>13 Tage, 19:12:02</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2486>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2486>BE!</A></TD>
                </TR>
                <TR>
                    <TD BGCOLOR=#006600>&nbsp</TD>
                    <TD>Stickerle</TD>
                    <TD ALIGN=CENTER>47 + 2 Crash</TD>
                    <TD>&nbsp;<FONT COLOR=#CC0000>war schon</FONT></TD>
                    <TD ALIGN=CENTER>1/8</TD>
                    <TD>2015-01-14 09:10:17</TD>
                    <TD>5 Tage, 17:13:46</TD>
                    <TD><A HREF=kickplayer.php?GID=78483&UID=2270>Kicken</A></TD>
                    <TD><A HREF=beplayer.php?GID=78483&UID=2270>BE!</A></TD>
                </TR>
            </tbody>
        </TABLE>
        <FORM>
            Link zur <A HREF=logs/78483.log>Logdatei</A>
        </FORM>
        <BR>
        <FONT SIZE=+2 COLOR=RED>Support Karopapier!!!!!</FONT>Nein, ich will mit Karopapier nicht Geld verdienen - wenn Ihr trotzdem an mich denken w&uuml;rdet, w&auml;re ich Euch zu tiefst verbunden. Einfach vor jedem Kauf/Besuch bei Amazon &uuml;ber
        <A HREF=http://www.karopapier.de/support.php>Support Karopapier</A> dort hingehen und schon ist Didi fr&ouml;hlicher...


        <script type="text/javascript">

            $('#tabspielinfo').tablesorter();


            var accesskeys = {
                '-1-1': 'q',
                '-10': 'a',
                '-11': 'y',
                '0-1': 'w',
                '00': 's',
                '01': 'x',
                '1-1': 'e',
                '10': 'd',
                '11': 'c'
            }

            $('area').each(function (i, e) {
                var rel = $(e).attr('rel');
                if (rel) {
                    //console.log(rel);
                    if (accesskeys[rel]) {
                        //console.log(accesskeys[rel]);
                        var title = $(e).attr('title');
                        $(e).attr('title', title + '   [' + accesskeys[rel] + ']');
                        $(e).attr('accesskey', accesskeys[rel]);
                    }
                }
            });

            //? RUNDENERSTER ?
            if (($('h1').text().indexOf('§') >= 0) || ($('h1').text().indexOf('$') >= 0)) {
                var wars = $('#tabspielinfo td:contains("war schon")');
                if (wars.length == 0) {
                    //alert("Es koennte sich hier um ein 'Rundenerster wiederholt'-Spiel handeln - und ich glaube DUUUU bist gerade Rundenerster!!");
                    $('#mapImage').css('border', '10px solid blue');
                }
            }

            var MapId = 96;

            var voteurl = "http://www.karopapier.de/api/map/" + MapId + "/vote.json";
            function initStarvote() {
                $.getJSON(voteurl + "?callback=?", function (data) {
                    $('#mapvote').trigger("newdata", data);
                });
            }
            ;

            $(document).ready(function () {

                $('#mapvote').bind("newdata", function (e, data) {
                    //console.log(data);
                    var mv = new StarVote($('#mapvote'), {
                        "picPath": "http://www.karopapier.de/images/starvote"
                    });
                    mv.setValue(data.myvote);
                    mv.setGlobalValue(data.avg);
                });

                $('#mapvote').bind("voted", function (e, vote) {
                    //console.log(vote);
                    $.ajax({
                        url: voteurl,
                        data: "vote=" + vote,
                        type: 'POST',
                        xhrFields: {
                            withCredentials: true
                        },
                        success: function (data) {
                            //console.log("gut",data);
                            $('#mapvote').trigger("newdata", data);
                        },
                        error: function (data) {
                            //console.log("bad",data);
                        },
                        dataType: "json"
                    });
                })

                initStarvote();
            });

        </script>

        <HR WIDTH=75%>
        <br />
        Letzter Satz im <a href="realchatframe.php">Chat</a>:<br />
        <B>Madeleine</B> (13:58): Oder Autokorrektur hat ihr dazwischengefunkt <BR><br />

        <script src="/js/GameStepUp.js"></script>

        <script>
            if (!/karopapier/.test(window.location.hostname)) {
                document.write('<scr' + 'ipt src="http://localhost:35729/livereload.js"></scr' + 'ipt>');
            }
            /*
            var styleEl = document.createElement("style");
            styleEl.appendChild(document.createTextNode(""));
            document.head.appendChild(styleEl);
            styleSheet = styleEl.sheet;
            styleSheet.insertRule(".road {fill: rgb(128, 128, 128)}",0);
            styleSheet.insertRule(".start {fill: url(#startPattern)}",1);
            //styleSheet.insertRule(".grass {fill: url(#startPattern) !important}",1);
            */

        </script>
    </BODY>
</HTML>
